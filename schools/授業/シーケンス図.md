# シーケンス図の書き方
[IT専科というサイトを参考](https://www.itsenka.com/contents/development/uml/sequence.html)にするとシーケンス図とは。。。
> シーケンス図とは、クラスやオブジェクト間のやりとりを時間軸に沿って表現する図です。

[アジャイルモデリング(AM)というサイト](https://www.ogis-ri.co.jp/otc/swec/process/am-res/am/artifacts/sequenceDiagram.html)を参考にして学習します。そして、下のような図があります。

![シーケンス図１](https://www.ogis-ri.co.jp/otc/swec/process/am-res/am/images/models/sequenceDiagramSystemLevel.jpg)

これは、手書きなのでちょっとわかりずらいですが、ポイントとしては、次のような部分です。

1. 登場人物が３人(アプリケーションを含む)
![](http://zenryokuservice.com/wp/wp-content/uploads/2021/10/シーケンス図１.png)

2. それぞれの時間軸が縦に伸びている
![](http://zenryokuservice.com/wp/wp-content/uploads/2021/10/シーケンス図２.png)

3. 縦軸に対して、横軸は「何かしらの動きを示す」
![](http://zenryokuservice.com/wp/wp-content/uploads/2021/10/シーケンス図３.png)

大まかに、このようなところがポイントになります。
[アジャイルモデリング(AM)というサイト](https://www.ogis-ri.co.jp/otc/swec/process/am-res/am/artifacts/sequenceDiagram.html)には、下のような説明がありました。

> これがシーケンス図と呼ばれている理由は明らかでしょう。ロジックの実行順序（シーケンス）がメッセージ(横向きの矢印)の順序で示されています。最初のメッセージは左上から始まり、次のメッセージはそのすぐ下に書く、というように表していきます。

## シーケンス図の内訳
![サービスレベルのシーケンス図](https://www.ogis-ri.co.jp/otc/swec/process/am-res/am/images/models/sequenceDiagramServiceLevel.jpg)

[参考サイト](https://www.ogis-ri.co.jp/otc/swec/process/am-res/am/artifacts/sequenceDiagram.html)には、下のような説明があります。
> 図の上部に横に並んでいる箱は、分類子またはそのインスタンスを表します。この分類子は通常、ユースケース、オブジェクト、クラス、またはアクターです。オブジェクトとクラスにはメッセージを送ることができるため(オブジェクトは操作の呼び出しを通じて、クラスは静的操作の呼び出しを通じてメッセージに応答します)、これらをシーケンス図に含めるのは筋が通っています。アクターも、利用シナリオを開始したり、利用シナリオで能動的な役割を果たすので、シーケンス図に含めることができます。オブジェクトにはUML標準の「名前: クラス名」という書式でラベルをつけます。この名前は必須ではありません(図で名前の付いていないオブジェクトのことを無名オブジェクトと呼びます)。クラスには「クラス名」という書式でラベルを付け、アクターには「アクター名」の書式で名前を付けます。オブジェクトのラベルには下線が引かれていますが、クラスとアクターには引かれていないことに注意してください。たとえば、図3の学生オブジェクトにはある学生という名前が付けられています。これが名前付きオブジェクトです。それに対してゼミのインスタンスは無名オブジェクトです。Studentのインスタンスに名前が付けられているのは、複数の場所でメッセージのパラメータとして使われているためです。ゼミのインスタンスの方は、図の他の場所で参照する必要がないので、無名にしておくことができます。図2では、学生クラスが永続性フレームワーククラスにメッセージを送っています(永続性フレームワーククラスには\<\<infrastructure>>というステレオタイプを付けてもよかったのですが、図を簡潔にしておくために付けませんでした)。クラスに対して送られたメッセージは、すべて静的メソッドとして実装します。これについては後で説明します。

まとめると次のようになります。
上の図で示した「登場人物」は、「ユースケース、オブジェクト、クラス、またはアクター」

* ユースケース：「申込用紙を書く」とか、「送信ボタンを押下」などのように人の動き、作業を示す。
* オブジェクト：クラスとかインスタンスのこと(厳密にはインスタンスの事)
* アクター　　；人のモデル(人を示す絵)

そして、オブジェクトはメッセージを送信することができるので、ほかのオブジェクトを呼び出し、何かしらの処理を行わせることができます。その処理が終わったら、また元のオブジェクトの線に戻ってきます。下のような矢印のことです。
![](http://zenryokuservice.com/wp/wp-content/uploads/2021/10/シーケンス図３.png)

※引用した文言の中に「**すべて静的メソッドとして実装します**」とありますが、これはこちらのサイトでそのように実装しているということです。別に**静的メソッドである必要はありません**。

そして、上記の手書きの画像をきれいに書くと下のようになるようです。
![](https://www.ogis-ri.co.jp/otc/swec/process/am-res/am/images/models/sequenceDiagramEnrollInSeminar.jpg)

ここで、シーケンス図に使用される図をまとめると、[IT専科というサイトの表を借りると](https://www.itsenka.com/contents/development/uml/sequence.html)下のようになります。

<table class="list" summary="構成要素一覧">
<caption>構成要素一覧</caption>
<tr>
<td class="head" colspan="2">要素</td>
<td class="head">表示形式</td>
<td class="head">意味</td>
</tr>
<tr>
<td colspan="2">ライフライン（Lifeline）</td>
<td style="text-align:center"><img src="https://www.itsenka.com/images/development/uml/uml-sequence03.gif" width="153" height="72" alt="ライフライン 記号" />
</td>
<td>使用するオブジェクトやクラスを表現します。どちらか一方なら省略可能です。</td>
</tr>
<tr>
<td colspan="2">実行仕様（ExecutionSpecification）</td>
<td style="text-align:center"><img src="https://www.itsenka.com/images/development/uml/uml-sequence04.gif" width="17" height="78" alt="実行仕様 記号" />
</td>
<td>生成されているライフラインが実行状態であることを意味します。</td>
</tr>
<tr>
<td colspan="2">停止（Stop）</td>
<td style="text-align:center"><img src="https://www.itsenka.com/images/development/uml/uml-sequence05.gif" width="40" height="40" alt="停止 記号" />
</td>
<td>生成されたライフライン自体の消滅を意味します。</td>
</tr>
<tr>
<td rowspan="5">メッセージ（Message）</td>
<td style="width:260px">同期（Synchronous）メッセージ</td>
<td style="text-align:center"><img src="https://www.itsenka.com/images/development/uml/uml-sequence06.gif" width="115" height="32" alt="同期メッセージ 記号" />
</td>
<td>送り先のライフラインの実行に同期されるメッセージを意味します。メッセージ名には具体的な関数やINCLUDEディレクティブ等を記入します。</td>
</tr>
<tr>
<td>非同期（Asynchronous）メッセージ</td>
<td style="text-align:center"><img src="https://www.itsenka.com/images/development/uml/uml-sequence07.gif" width="115" height="32" alt="非同期メッセージ 記号" />
</td>
<td>送り先のライフラインの実行に同期されないメッセージを意味します。メッセージ名には具体的な関数やINCLUDEディレクティブ等を記入します。</td>
</tr>
<tr>
<td>応答（Reply）メッセージ</td>
<td style="text-align:center"><img src="https://www.itsenka.com/images/development/uml/uml-sequence09.gif" width="115" height="33" alt="応答メッセージ 記号" />
</td>
<td>送り先のライフラインから送り手への戻り値を意味します。メッセージ名には戻り値を格納する具体的な変数名等を記入します。</td>
</tr>
<tr>
<td>ファウンド（Found）メッセージ</td>
<td style="text-align:center"><img src="https://www.itsenka.com/images/development/uml/uml-sequence09.gif" width="130" height="21" alt="ファウンドメッセージ 記号" />
</td>
<td>図解上にない送り手から送られた、もしくは送り手がダイアグラム上にないことを意味します。</td>
</tr>
<tr>
<td>ロスト（Lost）メッセージ</td>
<td style="text-align:center"><img src="https://www.itsenka.com/images/development/uml/uml-sequence10.gif" width="130" height="21" alt="ロストメッセージ 記号" />
</td>
<td>意図された受け手に送られていない、もしくは受け手がダイアグラム上にないことを意味します。</td>
</tr>
</table>
<p class="top"><a href="#wrapper">▲PageTop</a></p>
<h2 id="S03">制御構造の記述</h2>
<p>シーケンス図では、制御構造を表現するために「複合フラグメント」を使用します。種類および、記述例は次の通りです。</p>
<br />
<h3>複合フラグメントの種類</h3>
<p>複合フラグメントには、次の種類があります。</p>
<br />
<table class="list" summary="複合フラグメント一覧">
<caption>複合フラグメント一覧</caption>
<tr>
<td class="head">InteractionOperator</td>
<td class="head" style="width:240px">読み</td>
<td class="head">意味</td>
</tr>
<tr>
<td>ref</td>
<td>相互作用使用（InteractionUse）</td>
<td>別のシーケンス図を参照することを表します。</td>
</tr>
<tr>
<td>alt</td>
<td>オルタナティブ（Alternative）</td>
<td>分岐処理を表します。</td>
</tr>
<tr>
<td>opt</td>
<td>オプション（Option）</td>
<td>
<p>条件を満たした場合のみ実行される処理を表します。</p>
</td>
</tr>
<tr>
<td>par</td>
<td>パラレル（Parallel）</td>
<td>並列処理を表します。</td>
</tr>
<tr>
<td>loop</td>
<td>ループ（Loop）</td>
<td>ループ（繰り返し）処理を表します。</td>
</tr>
<tr>
<td>break</td>
<td>ブレイク（Break）</td>
<td>処理の中断を表します。</td>
</tr>
<tr>
<td>critical</td>
<td>クリティカル（Critical）</td>
<td>マルチスレッド環境での同期処理など、排他制御を表します。</td>
</tr>
<tr>
<td>assert</td>
<td>アサーション（Assert）</td>
<td>処理が妥当であるための定義を表します。</td>
</tr>
<tr>
<td>neg</td>
<td>否定（negation）</td>
<td>
<p>本来、実行されるはずがない処理（メッセージ）であることを表します。</p>
</td>
</tr>
<tr>
<td>ignore</td>
<td>無効（ignore）</td>
<td>あまり重要な処理（メッセージ）ではないことを表します。</td>
</tr>
<tr>
<td>consider</td>
<td>有効（Consider）</td>
<td>重要な処理（メッセージ）であることを表します。</td>
</tr>
</table>

## 基本的な処理を表現する
ここでいう「基本的な処理」とは、次のものを指します。

1. 参照(**REF**)
 ![](https://www.itsenka.com/images/development/uml/uml-sequence11.gif)
1. 条件分岐(**ALT**)
 ![](https://www.itsenka.com/images/development/uml/uml-sequence12.gif)
1. 条件判断(**OPT**)
 ![](https://www.itsenka.com/images/development/uml/uml-sequence13.gif)
1. 並列処理(**PAR**)
 ![](https://www.itsenka.com/images/development/uml/uml-sequence14.gif)
1. 反復処理（**LOOP**）
 ![](https://www.itsenka.com/images/development/uml/uml-sequence15.gif)
1. 中断（**BREAK**）
 ![](https://www.itsenka.com/images/development/uml/uml-sequence16.gif)
1. クリティカルセッション（**CRITICAL**）
 ![](https://www.itsenka.com/images/development/uml/uml-sequence17.gif)
1. アサート（**ASSERT**）
 ![](https://www.itsenka.com/images/development/uml/uml-sequence18.gif)
1. 不正なシーケンス（**NEG**）
 ![](https://www.itsenka.com/images/development/uml/uml-sequence19.gif)
1. 無効（**IGNORE**）
 ![](https://www.itsenka.com/images/development/uml/uml-sequence20.gif)
1. 有効（**CONSIDER**）
 ![](https://www.itsenka.com/images/development/uml/uml-sequence21.gif)

このような形で記述します。あとは、どのような動きを表現したいのか？を考えるだけです。
しかし、これらの「動き」を考えるためには、プログラミングの基礎を理解する必要があります。
